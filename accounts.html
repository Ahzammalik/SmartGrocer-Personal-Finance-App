<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Accounts - SmartGrocer</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #10b981;
            --primary-dark: #059669;
            --primary-light: #d1fae5;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .account-card {
            position: relative;
            overflow: hidden;
        }
        
        .account-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary) 0%, var(--primary-dark) 100%);
        }
        
        .balance-positive {
            color: #10b981;
        }
        
        .balance-negative {
            color: #ef4444;
        }
        
        .account-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
            transition: all 0.2s ease;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-1px);
        }
        
        .notification {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            padding: 12px 16px;
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .progress-bar {
            height: 6px;
            border-radius: 3px;
            background-color: #e5e7eb;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.5s ease;
        }
        
        .transaction-item {
            border-bottom: 1px solid #f3f4f6;
            padding: 12px 0;
            transition: background-color 0.2s ease;
        }
        
        .transaction-item:hover {
            background-color: #f9fafb;
        }
        
        .transaction-item:last-child {
            border-bottom: none;
        }
        
        #signin-overlay {
            z-index: 9999;
        }
    </style>
</head>
<body class="antialiased bg-gray-50">

    <div id="signin-overlay" class="fixed inset-0 bg-gray-100 z-50 flex items-center justify-center p-4">
        <div class="w-full max-w-sm text-center">
            <div class="mb-8">
                <i class="fas fa-wallet text-5xl text-primary mb-4"></i>
                <h1 class="text-4xl font-bold text-primary mb-2">SmartGrocer</h1>
                <p class="text-gray-600">Personal Finance Manager</p>
            </div>
            <p class="text-gray-600 mb-8">Please enter your name to get started.</p>
            <form id="signin-form">
                <input type="text" id="signin-name" placeholder="Your Name" class="w-full border border-gray-300 rounded-lg shadow-sm py-3 px-4 text-lg text-center focus:border-primary focus:ring-2 focus:ring-primary focus:ring-opacity-20" required autofocus>
                <button type="submit" class="mt-4 w-full bg-primary text-white font-bold py-3 px-4 rounded-lg hover:bg-green-700 transition-colors text-lg">
                    Start Managing Finances
                </button>
            </form>
        </div>
    </div>
    
    <div id="sidebar-overlay" class="hidden"></div>
    <aside id="sidebar" class="w-64 flex-shrink-0 bg-white transform -translate-x-full">
        <div class="h-full flex flex-col">
            <div class="h-20 flex items-center justify-center border-b">
                <h1 class="text-2xl font-bold text-primary">SmartGrocer</h1>
            </div>
            <nav class="flex-1 px-4 py-6 space-y-2">
                <a href="index.html" class="nav-link flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-green-100 hover:text-primary"><i class="fas fa-home w-6 h-6 mr-3"></i>Dashboard</a>
                <a href="income.html" class="nav-link flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-green-100 hover:text-primary"><i class="fas fa-money-bill-wave w-6 h-6 mr-3"></i>Income</a>
                <a href="expense.html" class="nav-link flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-green-100 hover:text-primary"><i class="fas fa-credit-card w-6 h-6 mr-3"></i>Expenses</a>
                <a href="accounts.html" class="nav-link flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-green-100 hover:text-primary active"><i class="fas fa-wallet w-6 h-6 mr-3"></i>Accounts</a>
                <a href="budget.html" class="nav-link flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-green-100 hover:text-primary"><i class="fas fa-chart-pie w-6 h-6 mr-3"></i>Budgets</a>
                <a href="reports.html" class="nav-link flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-green-100 hover:text-primary"><i class="fas fa-chart-line w-6 h-6 mr-3"></i>Reports</a>
                <a href="blogs.html" class="nav-link flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-green-100 hover:text-primary"><i class="fas fa-blog w-6 h-6 mr-3"></i>Blog</a>
                <a href="contact.html" class="nav-link flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-green-100 hover:text-primary"><i class="fas fa-envelope w-6 h-6 mr-3"></i>Contact Us</a>
                <a href="settings.html" class="nav-link flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-green-100 hover:text-primary"><i class="fas fa-cog w-6 h-6 mr-3"></i>Settings</a>
            </nav>
            <div class="px-4 py-4 border-t">
                <a href="#privacy" class="nav-link text-sm text-gray-500 hover:text-primary block">Privacy Policy</a>
                <a href="#terms" class="nav-link text-sm text-gray-500 hover:text-primary block mt-1">Terms & Conditions</a>
                <a href="#disclaimers" class="nav-link text-sm text-gray-500 hover:text-primary block mt-1">Disclaimers</a>
            </div>
        </div>
    </aside>

    <div id="main-app-container" class="hidden">
        <header class="flex justify-between items-center px-4 bg-white shadow-sm py-4">
            <button id="mobile-menu-button" class="text-gray-600 focus:outline-none"><i class="fas fa-bars text-2xl"></i></button>
            <h2 id="page-title" class="text-xl font-semibold text-gray-800">Accounts</h2>
            <div id="welcome-user-container" class="flex items-center">
                <span id="welcome-user-text" class="text-gray-600 hidden sm:block mr-3">Welcome, User!</span>
                <div class="w-10 h-10 rounded-full bg-primary flex items-center justify-center text-white font-bold" id="user-initial">U</div>
            </div>
        </header>

        <main class="p-4 md:p-6">
            <div id="accounts" class="page active fade-in">
                <!-- Summary Cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <div class="card p-5 gradient-bg text-white">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-sm opacity-90">Total Balance</p>
                                <h3 class="text-2xl font-bold mt-1">$<span id="total-balance">0.00</span></h3>
                            </div>
                            <i class="fas fa-chart-line text-xl opacity-80"></i>
                        </div>
                        <p class="text-xs mt-3 opacity-80">Across all accounts</p>
                    </div>
                    
                    <div class="card p-5">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-sm text-gray-500">Accounts</p>
                                <h3 class="text-2xl font-bold text-gray-800 mt-1"><span id="accounts-count">0</span></h3>
                            </div>
                            <i class="fas fa-wallet text-xl text-gray-400"></i>
                        </div>
                        <p class="text-xs text-gray-500 mt-3">Active accounts</p>
                    </div>
                    
                    <div class="card p-5">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-sm text-gray-500">Recent Transactions</p>
                                <h3 class="text-2xl font-bold text-gray-800 mt-1"><span id="recent-transactions">0</span></h3>
                            </div>
                            <i class="fas fa-exchange-alt text-xl text-gray-400"></i>
                        </div>
                        <p class="text-xs text-gray-500 mt-3">Last 30 days</p>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Left Column: Accounts and Transfer -->
                    <div class="lg:col-span-2 space-y-6">
                        <!-- Accounts Section -->
                        <div class="card p-6">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-xl font-bold text-gray-800">Your Accounts</h3>
                                <button id="add-account-btn" class="btn-primary flex items-center py-2 px-4 rounded-lg font-medium">
                                    <i class="fas fa-plus mr-2"></i>Add Account
                                </button>
                            </div>
                            
                            <!-- Accounts Grid -->
                            <div id="accounts-container" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                        </div>
                        
                        <!-- Transfer Section -->
                        <div class="card p-6">
                            <h4 class="text-lg font-semibold mb-4 text-gray-800">Transfer Between Accounts</h4>
                            <form id="transfer-form" class="space-y-4">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">From Account</label>
                                        <select id="from-account" class="w-full border border-gray-300 rounded-lg px-3 py-2.5 focus:border-primary focus:ring-2 focus:ring-primary focus:ring-opacity-20 transition-colors" required>
                                            <option value="">Select Account</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">To Account</label>
                                        <select id="to-account" class="w-full border border-gray-300 rounded-lg px-3 py-2.5 focus:border-primary focus:ring-2 focus:ring-primary focus:ring-opacity-20 transition-colors" required>
                                            <option value="">Select Account</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Amount</label>
                                    <div class="relative">
                                        <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500">$</span>
                                        <input type="number" id="transfer-amount" step="0.01" min="0.01" placeholder="0.00" class="w-full border border-gray-300 rounded-lg pl-8 pr-3 py-2.5 focus:border-primary focus:ring-2 focus:ring-primary focus:ring-opacity-20 transition-colors" required>
                                    </div>
                                </div>
                                
                                <div class="pt-2">
                                    <button type="submit" id="transfer-btn" class="w-full btn-primary flex items-center justify-center py-2.5 px-4 rounded-lg font-medium">
                                        <i class="fas fa-exchange-alt mr-2"></i>Transfer Funds
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <!-- Right Column: Recent Transactions -->
                    <div class="lg:col-span-1">
                        <div class="card p-6 h-full">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-lg font-semibold text-gray-800">Recent Transactions</h3>
                                <a href="#" class="text-sm text-primary font-medium hover:underline">View All</a>
                            </div>
                            
                            <div id="recent-transactions-container" class="space-y-1 max-h-96 overflow-y-auto">
                                <!-- Transactions will be populated here -->
                                <div class="text-center py-8 text-gray-500">
                                    <i class="fas fa-exchange-alt text-3xl mb-3 opacity-40"></i>
                                    <p>No recent transactions</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <div id="notification" class="notification hidden fixed top-4 right-4 z-50 max-w-sm"></div>
    
    <!-- Add Account Modal -->
    <div id="add-account-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-6">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold text-gray-800">Add New Account</h3>
                <button id="close-account-modal" class="text-gray-500 hover:text-gray-700 transition-colors">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            <form id="add-account-form" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Account Name</label>
                    <input type="text" id="account-name" placeholder="e.g., Checking Account, Savings" class="w-full border border-gray-300 rounded-lg px-3 py-2.5 focus:border-primary focus:ring-2 focus:ring-primary focus:ring-opacity-20 transition-colors" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Account Type</label>
                    <select id="account-type" class="w-full border border-gray-300 rounded-lg px-3 py-2.5 focus:border-primary focus:ring-2 focus:ring-primary focus:ring-opacity-20 transition-colors" required>
                        <option value="checking">Checking Account</option>
                        <option value="savings">Savings Account</option>
                        <option value="credit">Credit Card</option>
                        <option value="cash">Cash</option>
                        <option value="investment">Investment</option>
                        <option value="loan">Loan</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Initial Balance</label>
                    <div class="relative">
                        <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500">$</span>
                        <input type="number" id="account-balance" step="0.01" value="0.00" class="w-full border border-gray-300 rounded-lg pl-8 pr-3 py-2.5 focus:border-primary focus:ring-2 focus:ring-primary focus:ring-opacity-20 transition-colors" required>
                    </div>
                </div>
                <div class="flex space-x-3 pt-4">
                    <button type="button" id="cancel-account" class="flex-1 bg-gray-200 text-gray-700 font-medium py-3 px-4 rounded-lg hover:bg-gray-300 transition-colors">
                        Cancel
                    </button>
                    <button type="submit" class="flex-1 btn-primary font-medium py-3 px-4 rounded-lg">
                        Add Account
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Sample data for demonstration
        let accounts = JSON.parse(localStorage.getItem('smartgrocer-accounts')) || [];
        let transactions = JSON.parse(localStorage.getItem('smartgrocer-transactions')) || [];
        let currentUser = localStorage.getItem('smartgrocer-currentUser');
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            initializeSignIn();
            if (currentUser) {
                hideSignInOverlay();
            }
            initializeAccountsPage();
        });

        function initializeSignIn() {
            const signInForm = document.getElementById('signin-form');
            const signInName = document.getElementById('signin-name');
            
            signInForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const userName = signInName.value.trim();
                if (!userName) {
                    showNotification('Please enter your name', 'error');
                    return;
                }
                
                // Save user to localStorage
                localStorage.setItem('smartgrocer-currentUser', userName);
                currentUser = userName;
                
                // Update UI
                document.getElementById('welcome-user-text').textContent = `Welcome, ${userName}!`;
                document.getElementById('user-initial').textContent = userName.charAt(0).toUpperCase();
                
                // Hide sign-in overlay and show main app
                hideSignInOverlay();
                
                showNotification(`Welcome to SmartGrocer, ${userName}!`, 'success');
            });
        }
        
        function hideSignInOverlay() {
            document.getElementById('signin-overlay').classList.add('hidden');
            document.getElementById('main-app-container').classList.remove('hidden');
        }

        function initializeAccountsPage() {
            renderAccounts();
            setupAccountTransfers();
            setupAccountModal();
            updateSummaryCards();
            renderRecentTransactions();
        }

        function setupAccountModal() {
            const addAccountBtn = document.getElementById('add-account-btn');
            const modal = document.getElementById('add-account-modal');
            const closeBtn = document.getElementById('close-account-modal');
            const cancelBtn = document.getElementById('cancel-account');
            const form = document.getElementById('add-account-form');

            addAccountBtn.addEventListener('click', () => {
                modal.classList.remove('hidden');
                modal.classList.add('flex');
            });

            closeBtn.addEventListener('click', closeModal);
            cancelBtn.addEventListener('click', closeModal);

            form.addEventListener('submit', function(e) {
                e.preventDefault();
                addNewAccount();
            });

            function closeModal() {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
                form.reset();
            }
        }

        function addNewAccount() {
            const name = document.getElementById('account-name').value.trim();
            const type = document.getElementById('account-type').value;
            const balance = parseFloat(document.getElementById('account-balance').value) || 0;

            if (!name) {
                showNotification('Please enter an account name', 'error');
                return;
            }

            const newAccount = {
                id: generateId(),
                name,
                type,
                initialBalance: balance,
                createdAt: new Date().toISOString()
            };

            accounts.push(newAccount);
            saveAccounts();

            // Close modal and refresh
            document.getElementById('add-account-modal').classList.add('hidden');
            document.getElementById('add-account-form').reset();
            renderAccounts();
            updateTransferAccountOptions();
            updateSummaryCards();
            showNotification('Account added successfully', 'success');
        }

        function setupAccountTransfers() {
            updateTransferAccountOptions();
            
            document.getElementById('transfer-form').addEventListener('submit', function(e) {
                e.preventDefault();
                processAccountTransfer();
            });
        }

        function updateTransferAccountOptions() {
            const fromSelect = document.getElementById('from-account');
            const toSelect = document.getElementById('to-account');
            
            // Clear existing options except the first one
            fromSelect.innerHTML = '<option value="">Select Account</option>';
            toSelect.innerHTML = '<option value="">Select Account</option>';
            
            // Add account options
            accounts.forEach(account => {
                const balance = calculateAccountBalance(account.id);
                const optionText = `${account.name} ($${balance.toFixed(2)})`;
                
                const fromOption = new Option(optionText, account.id);
                const toOption = new Option(optionText, account.id);
                
                fromSelect.add(fromOption);
                toSelect.add(toOption);
            });
        }

        function processAccountTransfer() {
            const fromAccountId = document.getElementById('from-account').value;
            const toAccountId = document.getElementById('to-account').value;
            const amount = parseFloat(document.getElementById('transfer-amount').value);
            const transferBtn = document.getElementById('transfer-btn');
            
            if (!fromAccountId || !toAccountId) {
                showNotification('Please select both accounts', 'error');
                return;
            }
            
            if (fromAccountId === toAccountId) {
                showNotification('Cannot transfer to the same account', 'error');
                return;
            }
            
            if (!amount || amount <= 0) {
                showNotification('Amount must be greater than zero', 'error');
                return;
            }
            
            const fromAccount = accounts.find(a => a.id === fromAccountId);
            const toAccount = accounts.find(a => a.id === toAccountId);
            const fromAccountBalance = calculateAccountBalance(fromAccountId);
            
            if (fromAccountBalance < amount) {
                showNotification('Insufficient balance in source account', 'error');
                return;
            }
            
            // Show loading state
            const originalText = transferBtn.innerHTML;
            transferBtn.innerHTML = '<div class="loading"></div>';
            transferBtn.disabled = true;
            
            // Simulate processing delay
            setTimeout(() => {
                // Create transfer transactions
                const transferOut = {
                    id: generateId(),
                    type: 'expense',
                    description: `Transfer to ${toAccount.name}`,
                    amount,
                    category: 'Transfer',
                    date: new Date().toISOString().split('T')[0],
                    accountId: fromAccountId,
                    isTransfer: true,
                    transferTo: toAccountId,
                    createdAt: new Date().toISOString()
                };
                
                const transferIn = {
                    id: generateId(),
                    type: 'income',
                    description: `Transfer from ${fromAccount.name}`,
                    amount,
                    category: 'Transfer',
                    date: new Date().toISOString().split('T')[0],
                    accountId: toAccountId,
                    isTransfer: true,
                    transferFrom: fromAccountId,
                    createdAt: new Date().toISOString()
                };
                
                transactions.push(transferOut, transferIn);
                saveTransactions();
                
                document.getElementById('transfer-form').reset();
                showNotification('Transfer completed successfully', 'success');
                
                // Refresh displays
                renderAccounts();
                updateTransferAccountOptions();
                updateSummaryCards();
                renderRecentTransactions();
                
                // Restore button
                transferBtn.innerHTML = originalText;
                transferBtn.disabled = false;
            }, 1000);
        }

        function renderAccounts() {
            const container = document.getElementById('accounts-container');
            if (!container) return;

            if (accounts.length === 0) {
                container.innerHTML = `
                    <div class="col-span-2 text-center py-12">
                        <i class="fas fa-wallet text-6xl text-gray-300 mb-4"></i>
                        <h3 class="text-xl font-semibold text-gray-600 mb-2">No Accounts Yet</h3>
                        <p class="text-gray-500">Add your first account to get started with tracking your finances.</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = accounts.map(account => {
                const balance = calculateAccountBalance(account.id);
                const icon = getAccountIcon(account.type);
                const color = getAccountColor(account.type);
                
                return `
                    <div class="account-card bg-white rounded-xl border border-gray-200 p-5 hover:shadow-md transition-all duration-200 cursor-pointer">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <div class="account-icon ${color} text-white">
                                    <i class="${icon}"></i>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-800">${account.name}</h4>
                                    <p class="text-sm text-gray-600 capitalize">${account.type.replace('_', ' ')}</p>
                                </div>
                            </div>
                        </div>
                        <div class="mt-4">
                            <p class="text-2xl font-bold ${balance >= 0 ? 'balance-positive' : 'balance-negative'}">
                                $${balance.toFixed(2)}
                            </p>
                            <p class="text-xs text-gray-500 mt-1">Current Balance</p>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateSummaryCards() {
            // Update total balance
            const totalBalance = accounts.reduce((total, account) => {
                return total + calculateAccountBalance(account.id);
            }, 0);
            
            document.getElementById('total-balance').textContent = totalBalance.toFixed(2);
            
            // Update accounts count
            document.getElementById('accounts-count').textContent = accounts.length;
            
            // Update recent transactions count (last 30 days)
            const thirtyDaysAgo = new Date();
            thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
            
            const recentTransactionsCount = transactions.filter(transaction => {
                return new Date(transaction.date) >= thirtyDaysAgo;
            }).length;
            
            document.getElementById('recent-transactions').textContent = recentTransactionsCount;
        }

        function renderRecentTransactions() {
            const container = document.getElementById('recent-transactions-container');
            
            // Get recent transactions (last 5)
            const recentTransactions = transactions
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 5);
            
            if (recentTransactions.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <i class="fas fa-exchange-alt text-3xl mb-3 opacity-40"></i>
                        <p>No recent transactions</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = recentTransactions.map(transaction => {
                const account = accounts.find(a => a.id === transaction.accountId);
                const isIncome = transaction.type === 'income';
                const amountClass = isIncome ? 'text-green-600' : 'text-red-600';
                const amountPrefix = isIncome ? '+' : '-';
                
                return `
                    <div class="transaction-item">
                        <div class="flex justify-between items-center">
                            <div class="flex-1">
                                <p class="font-medium text-gray-800 text-sm">${transaction.description}</p>
                                <div class="flex items-center mt-1">
                                    <span class="text-xs text-gray-500">${formatDate(transaction.date)}</span>
                                    <span class="mx-2 text-gray-300">â€¢</span>
                                    <span class="text-xs text-gray-500">${account ? account.name : 'Unknown Account'}</span>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="font-semibold ${amountClass}">${amountPrefix}$${transaction.amount.toFixed(2)}</p>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getAccountIcon(type) {
            const icons = {
                'checking': 'fas fa-landmark',
                'savings': 'fas fa-piggy-bank',
                'credit': 'fas fa-credit-card',
                'cash': 'fas fa-money-bill-wave',
                'investment': 'fas fa-chart-line',
                'loan': 'fas fa-hand-holding-usd',
                'other': 'fas fa-wallet'
            };
            return icons[type] || icons.other;
        }

        function getAccountColor(type) {
            const colors = {
                'checking': 'bg-blue-500',
                'savings': 'bg-green-500',
                'credit': 'bg-purple-500',
                'cash': 'bg-yellow-500',
                'investment': 'bg-indigo-500',
                'loan': 'bg-red-500',
                'other': 'bg-gray-500'
            };
            return colors[type] || colors.other;
        }

        // Utility functions
        function generateId() {
            return '_' + Math.random().toString(36).substr(2, 9);
        }

        function calculateAccountBalance(accountId) {
            const account = accounts.find(a => a.id === accountId);
            if (!account) return 0;
            
            const accountTransactions = transactions.filter(t => t.accountId === accountId);
            const income = accountTransactions
                .filter(t => t.type === 'income')
                .reduce((sum, t) => sum + t.amount, 0);
                
            const expenses = accountTransactions
                .filter(t => t.type === 'expense')
                .reduce((sum, t) => sum + t.amount, 0);
                
            return (account.initialBalance || 0) + income - expenses;
        }

        function saveAccounts() {
            localStorage.setItem('smartgrocer-accounts', JSON.stringify(accounts));
        }

        function saveTransactions() {
            localStorage.setItem('smartgrocer-transactions', JSON.stringify(transactions));
        }

        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            const bgColor = type === 'success' ? 'bg-green-500' : 
                           type === 'error' ? 'bg-red-500' : 
                           type === 'warning' ? 'bg-yellow-500' : 'bg-blue-500';
            
            notification.innerHTML = `
                <div class="${bgColor} text-white p-4 rounded-lg flex items-center">
                    <i class="fas ${type === 'success' ? 'fa-check-circle' : 
                                 type === 'error' ? 'fa-exclamation-circle' : 
                                 type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle'} mr-3"></i>
                    <span>${message}</span>
                </div>
            `;
            
            notification.classList.remove('hidden');
            
            setTimeout(() => {
                notification.classList.add('hidden');
            }, 3000);
        }

        function formatDate(dateString) {
            const options = { month: 'short', day: 'numeric' };
            return new Date(dateString).toLocaleDateString('en-US', options);
        }
    </script>
</body>
</html>
